# Disable gzip for OTLP endpoints to prevent Content-Encoding mismatch
# The OpenTelemetry SDK expects uncompressed responses for small payloads,
# but nginx may add Content-Encoding: gzip header without actually compressing
# responses under gzip_min_length threshold.
location ~ ^/v1/(traces|logs|metrics) {
    gzip off;
    proxy_pass http://errata-dev-5000;
    proxy_http_version 1.1;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
}
