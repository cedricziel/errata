{# Multi-select facet (checkboxes) #}
<div class="facet-group" data-facet="{{ facet.attribute }}" data-facet-type="multi">
    <button type="button"
            class="w-full px-4 py-2 flex items-center justify-between text-left text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none"
            data-action="click->query-builder#toggleFacet"
            data-expanded="{{ facet.expanded ? 'true' : 'false' }}">
        <span>{{ facet.label }}</span>
        <svg class="h-4 w-4 transform transition-transform {{ facet.expanded ? 'rotate-180' : '' }}" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
        </svg>
    </button>
    <div class="facet-values px-4 pb-3 space-y-1 {{ facet.expanded ? '' : 'hidden' }}">
        {% for value in facet.values %}
        <label class="flex items-center justify-between cursor-pointer py-1">
            <div class="flex items-center space-x-2">
                <input type="checkbox"
                       name="facet_{{ facet.attribute }}[]"
                       value="{{ value.value }}"
                       {% if value.selected %}checked{% endif %}
                       class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"
                       data-action="change->query-builder#onFacetChange"
                       data-facet-attribute="{{ facet.attribute }}">
                <span class="text-sm text-gray-700 truncate">{{ value.value|default('(empty)') }}</span>
            </div>
            <span class="text-xs text-gray-500 ml-2">{{ value.count }}</span>
        </label>
        {% endfor %}
        {% if facet.totalCount > facet.values|length %}
        <div class="pt-1 text-xs text-gray-400">
            +{{ facet.totalCount - facet.values|length }} more
        </div>
        {% endif %}
    </div>
</div>
